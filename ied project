#define buzzer A0
#define speakerPin A1    // ultrasonic sensor
#define TrigPin1 11       // us 1
#define EchoPin1 10
#define TrigPin2 8     // us 2 
#define EchoPin2 7
servo servo;
servo.attach(10);    // connect to pin 10
servo.write(90);
int pos=10;      // move servo to 90 degrees
int dist;

#define motor_board_input_pin_IN2 6      //Connect to Arduino pin 6               // motors
#define motor_board_input_pin_IN1 9          //Connect to Arduino pin 9
#define motor_board_input_pin_IN4 3      //Connect to Arduino pin 3
#define motor_board_input_pin_IN3 5          //Connect to Arduino pin 5

#include <Servo.h>                      // lcd screen display
#include <LiquidCrystal_I2C.h>
LiquidCrystal_I2C lcd(0x27, 16, 2);
int IRvalues;
int duration;
int distance;

#define IR1Pin  A0      // A0 input pin for IR sensor
int IR1_Value = 0;
#define BLACK_TAPE_THRESHOLD 500        // store IR sensor value


void setup() 
{
  serial.begin(9600);
  PinMode(2,INPUT_PULLUP);   // target sensor board A
  PinMode(4,INPUT_PULLUP);  // taget sensor board B
  PCICR |= B00000100;   // Enable interrupts on PD port  Bit 2 enables interrupts
  PCMSK2 |= B00010100;  // Trigger interrupts on pins D2 and D4
  lcd.init();
  lcd.begin(16, 2);  // shows that is it 16 colums and 2 rows
  lcd.backlight();
  lcd.setCursor(0,0);
  lcd.print("system starting");
  delay(1000);


  pinMode(TrigPin1, OUTPUT);   // ultrasensor number 1 
  PinMode(EchpPin1, INPUT);
  PinMode(speakerPin, OUTPUT);
  servo.attach(A0);    // Tell the servo object that we've connected to pin 8
  servo.write(0);     // Helps to adjust the initial position
  delay(40);  

   pinMode(motor_board_input_pin_IN2, OUTPUT);    // motor
  pinMode(motor_board_input_pin_IN1, OUTPUT); 
  pinMode(motor_board_input_pin_IN4, OUTPUT); 
  pinMode(motor_board_input_pin_IN3, OUTPUT); 

 pinMode(IR_PIN, OUTPUT);
  Serial.print("Analog IR Sensor 1.\n");    // IR sensor

  {pinMode(buzzer, OUTPUT);}  // buzzer 

  pinMode(TrigPin2, OUTPUT);  // ultrasensor number 2
  PinMode(EchoPin2 , INPUT);

  delay(200);

}

void loop() 
{
  void testSensors() {
  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("Testing Sensors");

  IRvalues= analogRead(IR_PIN);
  serial.print("IR");
  lcd.print(irvalue);
  delay(1500);

   digitalWrite(TRIG_PIN_1, LOW);
   delay(200);
  digitalWrite(TRIG_PIN_1, HIGH);
  delay(200);
  digitalWrite(TRIG_PIN_1, LOW);

   digitalWrite(TRIG_PIN_2, LOW);
  delay(200);
  digitalWrite(TRIG_PIN_2, HIGH);
  delay(200);
  digitalWrite(TRIG_PIN_2, LOW);

  duration = pulseIn(ECHO_PIN_1, HIGH);
  distance = duration * 0.034 / 2;

duration = pulseIn(ECHO_PIN_1, HIGH);
  distance = duration * 0.034 / 2;
  delay(100);

  serial.print("Distance1: ");
  serial.print(Distance);
  lcd.clear();
  delay(300);
  lcd.setCursor(0,0);
  lcd.print("Distance2: ");
  lcd.setCursor(0,1);
  Lcd.print(Distance);
  delay(1500);
  }
  void moveforward()
  {
    lcd.clear();
    lcd.setCursor(0,0);
    lcd.print("moving forward ");
    digitalWrite(IN1, HIGH);
  digitalWrite(IN2, LOW);
  digitalWrite(IN3, HIGH);
  digitalWrite(IN4, LOW);
  }
  void StartProgram(){
    Dstance_US=readUltrasonic();

     digitalWrite(TRIG_PIN_1, LOW);
   delay(200);
  digitalWrite(TRIG_PIN_1, HIGH);
  delay(200);
  digitalWrite(TRIG_PIN_1, LOW);

   digitalWrite(TRIG_PIN_2, LOW);
  delay(200);
  digitalWrite(TRIG_PIN_2, HIGH);
  delay(200);
  digitalWrite(TRIG_PIN_2, LOW);

   duration = pulseIn(ECHO_PIN_1, HIGH);
  distance = duration * 0.034 / 2;

duration = pulseIn(ECHO_PIN_1, HIGH);
  OBSTACLE_DISTANCE = duration * 0.034 / 2;
  delay(100);

    int obstacleDetected = (distance < OBSTACLE_DISTANCE);
    int tapeDetected= (irvalue< BLACK_TAPE_THRESHOLD);

    if (obstacleDetected || !tapeDetected) {
    stopCar();
    digitalWrite(BUZZER, HIGH);
    lcd.setCursor(0, 0);
    lcd.print("STOPPED        ");
    
    if(obstacleDetected){
      lcd.setCursor(0,1);
      lcd.Print("obstacle Ahead");
      delay(100);
    }
    else(){



 
 

  }
    









  }


}
